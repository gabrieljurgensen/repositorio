<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Teste API - Produtos</title>
</head>
<body>
    <h1>Testar API de Produtos</h1>
    <button onclick="listarProdutos()">Listar Produtos</button>
    <ul id="produtos"></ul>
    <hr>
    <h2>Cadastrar Produto</h2>
    <form id="formProduto">
        <input type="text" id="nome" placeholder="Nome" required>
        <input type="number" id="preco_pago" placeholder="Preço Pago" required step="0.01">
        <input type="text" id="descricao" placeholder="Descrição">
        <input type="number" id="preco_vendido" placeholder="Preço Vendido" step="0.01">
        <input type="number" id="id_categoria" placeholder="ID Categoria" required>
        <input type="number" id="status" placeholder="Status" required>
        <button type="submit">Cadastrar</button>
    </form>
    <div id="mensagem"></div>
    <script>
        function listarProdutos() {
            fetch('http://localhost:3000/produto')
                .then(res => res.json())
                .then(data => {
                    const ul = document.getElementById('produtos');
                    ul.innerHTML = '';
                    data.forEach(prod => {
                        const li = document.createElement('li');
                        li.textContent = `${prod.id}: ${prod.nome} - R$ ${prod.preco_pago}`;
                        ul.appendChild(li);
                    });
                });
        }
        document.getElementById('formProduto').onsubmit = function(e) {
            e.preventDefault();
            const body = {
                nome: document.getElementById('nome').value,
                preco_pago: parseFloat(document.getElementById('preco_pago').value),
                descricao: document.getElementById('descricao').value,
                preco_vendido: parseFloat(document.getElementById('preco_vendido').value) || undefined,
                id_categoria: parseInt(document.getElementById('id_categoria').value),
                status: parseInt(document.getElementById('status').value)
            };
            fetch('http://localhost:3000/produto', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(body)
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('mensagem').textContent = data.message || data.error;
                listarProdutos();
            });
        };
    </script>
</body>
</html>